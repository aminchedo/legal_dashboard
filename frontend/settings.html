<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุชูุธูุงุช | ุณุงูุงูู ููุดููุฏ</title>
    
    <!-- Preconnect for better performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    
    <!-- ูููุช ู ุขฺฉููโูุง -->
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <div class="dashboard-container">
        <aside class="sidebar" id="sidebar">
            <!-- Sidebar Header -->
            <div class="sidebar-header">
                <a href="index.html" class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-gavel"></i>
                    </div>
                    <span class="logo-text">ุฏุงุดุจูุฑุฏ ุญููู</span>
                </a>
                <button class="mobile-menu-toggle" id="mobile-menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
            </div>

            <!-- Navigation -->
            <nav class="main-nav">
                <div class="nav-section">
                    <h4 class="nav-title">ุงุตู</h4>
                    <ul class="nav-menu">
                        <li class="nav-item">
                            <a href="index.html" class="nav-link" data-nav="dashboard">
                                <span class="nav-icon"><i class="fas fa-tachometer-alt"></i></span>
                                <span>ุฏุงุดุจูุฑุฏ</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="documents.html" class="nav-link" data-nav="documents">
                                <span class="nav-icon"><i class="fas fa-file-alt"></i></span>
                                <span>ูุฏุฑุช ุงุณูุงุฏ</span>
                                <span class="nav-badge" data-badge="documents">0</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="upload.html" class="nav-link" data-nav="upload">
                                <span class="nav-icon"><i class="fas fa-cloud-upload-alt"></i></span>
                                <span>ุขูพููุฏ ูุงู</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="search.html" class="nav-link" data-nav="search">
                                <span class="nav-icon"><i class="fas fa-search"></i></span>
                                <span>ุฌุณุชุฌู</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="analytics.html" class="nav-link" data-nav="analytics">
                                <span class="nav-icon"><i class="fas fa-chart-bar"></i></span>
                                <span>ุชุญูู ู ฺฏุฒุงุฑุด</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="nav-section">
                    <h4 class="nav-title">ุณุณุชู</h4>
                    <ul class="nav-menu">
                        <li class="nav-item">
                            <a href="system-health.html" class="nav-link" data-nav="systemHealth">
                                <span class="nav-icon"><i class="fas fa-heartbeat"></i></span>
                                <span>ูุถุนุช ุณุณุชู</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="settings.html" class="nav-link active" data-nav="settings">
                                <span class="nav-icon"><i class="fas fa-cog"></i></span>
                                <span>ุชูุธูุงุช</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
        </aside>

        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <h1 class="header-title">ุชูุธูุงุช</h1>
                <div class="header-actions">
                    <button class="btn btn-secondary" id="reset-settings-btn">
                        <i class="fas fa-undo"></i>
                        ุจุงุฒูุดุงู
                    </button>
                    <button class="btn btn-primary" id="save-settings-btn">
                        <i class="fas fa-save"></i>
                        ุฐุฎุฑู ุชูุธูุงุช
                    </button>
                    <button class="btn-icon" id="user-menu-btn">
                        <i class="fas fa-user-circle"></i>
                    </button>
                    <button class="btn-icon" id="notification-bell">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge" id="notification-badge">0</span>
                    </button>
                </div>
            </header>

            <!-- Breadcrumbs -->
            <div class="breadcrumb-container" id="breadcrumb-container">
                <a href="index.html" class="breadcrumb-item">
                    <i class="fas fa-home"></i>
                    <span>ุฎุงูู</span>
                </a>
                <i class="fas fa-angle-left mx-2 text-gray-400"></i>
                <span class="breadcrumb-item active" aria-current="page">ุชูุธูุงุช</span>
            </div>

            <!-- Settings Tabs -->
            <section class="settings-section">
                <div class="settings-tabs">
                    <button class="tab-btn active" data-tab="general">ุนููู</button>
                    <button class="tab-btn" data-tab="appearance">ุธุงูุฑ</button>
                    <button class="tab-btn" data-tab="notifications">ุงุนูุงูโูุง</button>
                    <button class="tab-btn" data-tab="security">ุงููุช</button>
                    <button class="tab-btn" data-tab="advanced">ูพุดุฑูุชู</button>
                </div>

                <div class="tab-content">
                    <!-- General Settings -->
                    <div class="tab-pane active" id="general-tab">
                        <div class="settings-group">
                            <h3>ุชูุธูุงุช ุนููู</h3>
                            
                            <div class="form-group">
                                <label for="language-select">ุฒุจุงู:</label>
                                <select id="language-select" class="form-select">
                                    <option value="fa" selected>ูุงุฑุณ</option>
                                    <option value="en">English</option>
                                    <option value="ar">ุงูุนุฑุจูุฉ</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="timezone-select">ููุทูู ุฒูุงู:</label>
                                <select id="timezone-select" class="form-select">
                                    <option value="Asia/Tehran" selected>ุชูุฑุงู (UTC+3:30)</option>
                                    <option value="UTC">UTC</option>
                                    <option value="Europe/London">ููุฏู (UTC+0)</option>
                                    <option value="America/New_York">ูููุฑฺฉ (UTC-5)</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="date-format">ูุฑูุช ุชุงุฑุฎ:</label>
                                <select id="date-format" class="form-select">
                                    <option value="jalali" selected>ุดูุณ</option>
                                    <option value="gregorian">ููุงุฏ</option>
                                    <option value="both">ูุฑ ุฏู</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="auto-save">ุฐุฎุฑู ุฎูุฏฺฉุงุฑ:</label>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="auto-save" checked>
                                    <label for="auto-save"></label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="auto-save-interval">ูุงุตูู ุฐุฎุฑู ุฎูุฏฺฉุงุฑ (ุฏููู):</label>
                                <input type="number" id="auto-save-interval" class="form-input" value="5" min="1" max="60">
                            </div>
                        </div>
                    </div>

                    <!-- Appearance Settings -->
                    <div class="tab-pane" id="appearance-tab">
                        <div class="settings-group">
                            <h3>ุชูุธูุงุช ุธุงูุฑ</h3>
                            
                            <div class="form-group">
                                <label for="theme-select">ุชู:</label>
                                <select id="theme-select" class="form-select">
                                    <option value="auto" selected>ุฎูุฏฺฉุงุฑ</option>
                                    <option value="light">ุฑูุดู</option>
                                    <option value="dark">ุชุงุฑฺฉ</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="color-scheme">ุฑูฺฏ ุงุตู:</label>
                                <div class="color-picker">
                                    <input type="color" id="color-scheme" value="#3b82f6">
                                    <span class="color-preview"></span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="font-size">ุงูุฏุงุฒู ูููุช:</label>
                                <select id="font-size" class="form-select">
                                    <option value="small">ฺฉูฺฺฉ</option>
                                    <option value="medium" selected>ูุชูุณุท</option>
                                    <option value="large">ุจุฒุฑฺฏ</option>
                                    <option value="xlarge">ุฎู ุจุฒุฑฺฏ</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="animation-toggle">ุงููุดูโูุง:</label>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="animation-toggle" checked>
                                    <label for="animation-toggle"></label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="compact-mode">ุญุงูุช ูุดุฑุฏู:</label>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="compact-mode">
                                    <label for="compact-mode"></label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Notifications Settings -->
                    <div class="tab-pane" id="notifications-tab">
                        <div class="settings-group">
                            <h3>ุชูุธูุงุช ุงุนูุงูโูุง</h3>
                            
                            <div class="form-group">
                                <label for="notifications-enabled">ูุนุงูโุณุงุฒ ุงุนูุงูโูุง:</label>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="notifications-enabled" checked>
                                    <label for="notifications-enabled"></label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="sound-notifications">ุงุนูุงูโูุง ุตูุช:</label>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="sound-notifications" checked>
                                    <label for="sound-notifications"></label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="email-notifications">ุงุนูุงูโูุง ุงูู:</label>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="email-notifications">
                                    <label for="email-notifications"></label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="notification-types">ููุน ุงุนูุงูโูุง:</label>
                                <div class="checkbox-group">
                                    <label class="checkbox-item">
                                        <input type="checkbox" checked> ุขูพููุฏ ูุงู
                                    </label>
                                    <label class="checkbox-item">
                                        <input type="checkbox" checked> ุชฺฉูู ูพุฑุฏุงุฒุด
                                    </label>
                                    <label class="checkbox-item">
                                        <input type="checkbox" checked> ุฎุทุงูุง ุณุณุชู
                                    </label>
                                    <label class="checkbox-item">
                                        <input type="checkbox"> ุจูโุฑูุฒุฑุณุงูโูุง
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="notification-duration">ูุฏุช ููุงุด ุงุนูุงู (ุซุงูู):</label>
                                <input type="number" id="notification-duration" class="form-input" value="5" min="1" max="30">
                            </div>
                        </div>
                    </div>

                    <!-- Security Settings -->
                    <div class="tab-pane" id="security-tab">
                        <div class="settings-group">
                            <h3>ุชูุธูุงุช ุงููุช</h3>
                            
                            <div class="form-group">
                                <label for="session-timeout">ูุฏุช ุฒูุงู ูุดุณุช (ุฏููู):</label>
                                <input type="number" id="session-timeout" class="form-input" value="30" min="5" max="480">
                            </div>

                            <div class="form-group">
                                <label for="two-factor-auth">ุงุญุฑุงุฒ ููุช ุฏู ูุฑุญููโุง:</label>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="two-factor-auth">
                                    <label for="two-factor-auth"></label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="password-change">ุชุบุฑ ุฑูุฒ ุนุจูุฑ:</label>
                                <button class="btn btn-secondary" id="change-password-btn">
                                    <i class="fas fa-key"></i>
                                    ุชุบุฑ ุฑูุฒ ุนุจูุฑ
                                </button>
                            </div>

                            <div class="form-group">
                                <label for="login-history">ุชุงุฑุฎฺู ูุฑูุฏ:</label>
                                <button class="btn btn-secondary" id="view-login-history-btn">
                                    <i class="fas fa-history"></i>
                                    ูุดุงูุฏู ุชุงุฑุฎฺู
                                </button>
                            </div>

                            <div class="form-group">
                                <label for="data-encryption">ุฑูุฒฺฏุฐุงุฑ ุฏุงุฏูโูุง:</label>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="data-encryption" checked>
                                    <label for="data-encryption"></label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Advanced Settings -->
                    <div class="tab-pane" id="advanced-tab">
                        <div class="settings-group">
                            <h3>ุชูุธูุงุช ูพุดุฑูุชู</h3>
                            
                            <div class="form-group">
                                <label for="debug-mode">ุญุงูุช ุฏุจุงฺฏ:</label>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="debug-mode">
                                    <label for="debug-mode"></label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="cache-size">ุงูุฏุงุฒู ฺฉุด (MB):</label>
                                <input type="number" id="cache-size" class="form-input" value="100" min="10" max="1000">
                            </div>

                            <div class="form-group">
                                <label for="api-timeout">ุชุงูโุงูุช API (ุซุงูู):</label>
                                <input type="number" id="api-timeout" class="form-input" value="30" min="5" max="300">
                            </div>

                            <div class="form-group">
                                <label for="max-upload-size">ุญุฏุงฺฉุซุฑ ุญุฌู ุขูพููุฏ (MB):</label>
                                <input type="number" id="max-upload-size" class="form-input" value="50" min="1" max="500">
                            </div>

                            <div class="form-group">
                                <label for="concurrent-uploads">ุชุนุฏุงุฏ ุขูพููุฏ ููุฒูุงู:</label>
                                <input type="number" id="concurrent-uploads" class="form-input" value="3" min="1" max="10">
                            </div>

                            <div class="form-group">
                                <label for="export-format">ูุฑูุช ูพุดโูุฑุถ ุตุงุฏุฑุงุช:</label>
                                <select id="export-format" class="form-select">
                                    <option value="pdf" selected>PDF</option>
                                    <option value="excel">Excel</option>
                                    <option value="csv">CSV</option>
                                    <option value="json">JSON</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Data Management -->
            <section class="data-management">
                <div class="management-header">
                    <h3>ูุฏุฑุช ุฏุงุฏูโูุง</h3>
                </div>

                <div class="management-grid">
                    <div class="management-card">
                        <div class="card-icon">
                            <i class="fas fa-download"></i>
                        </div>
                        <div class="card-content">
                            <h4>ุตุงุฏุฑุงุช ุฏุงุฏูโูุง</h4>
                            <p>ุฏุงูููุฏ ุชูุงู ุฏุงุฏูโูุง ุดุฎุต ู ุชูุธูุงุช</p>
                            <button class="btn btn-secondary" id="export-data-btn">
                                <i class="fas fa-download"></i>
                                ุตุงุฏุฑุงุช
                            </button>
                        </div>
                    </div>

                    <div class="management-card">
                        <div class="card-icon">
                            <i class="fas fa-upload"></i>
                        </div>
                        <div class="card-content">
                            <h4>ูุงุฑุฏุงุช ุฏุงุฏูโูุง</h4>
                            <p>ุจุงุฒฺฏุฑุฏุงู ุชูุธูุงุช ุงุฒ ูุงู ูพุดุชุจุงู</p>
                            <button class="btn btn-secondary" id="import-data-btn">
                                <i class="fas fa-upload"></i>
                                ูุงุฑุฏุงุช
                            </button>
                        </div>
                    </div>

                    <div class="management-card">
                        <div class="card-icon">
                            <i class="fas fa-trash"></i>
                        </div>
                        <div class="card-content">
                            <h4>ูพุงฺฉ ฺฉุฑุฏู ฺฉุด</h4>
                            <p>ูพุงฺฉ ฺฉุฑุฏู ุชูุงู ุฏุงุฏูโูุง ูููุช</p>
                            <button class="btn btn-danger" id="clear-cache-btn">
                                <i class="fas fa-trash"></i>
                                ูพุงฺฉ ฺฉุฑุฏู
                            </button>
                        </div>
                    </div>

                    <div class="management-card">
                        <div class="card-icon">
                            <i class="fas fa-redo"></i>
                        </div>
                        <div class="card-content">
                            <h4>ุจุงุฒูุดุงู ฺฉุงูู</h4>
                            <p>ุจุงุฒฺฏุฑุฏุงู ุชูุงู ุชูุธูุงุช ุจู ุญุงูุช ูพุดโูุฑุถ</p>
                            <button class="btn btn-danger" id="reset-all-btn">
                                <i class="fas fa-redo"></i>
                                ุจุงุฒูุดุงู
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Account Information -->
            <section class="account-info">
                <div class="account-header">
                    <h3>ุงุทูุงุนุงุช ุญุณุงุจ ฺฉุงุฑุจุฑ</h3>
                </div>

                <div class="account-details">
                    <div class="detail-item">
                        <span class="detail-label">ูุงู ฺฉุงุฑุจุฑ:</span>
                        <span class="detail-value">admin@legal.com</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">ูุงู ฺฉุงูู:</span>
                        <span class="detail-value">ูุฏุฑ ุณุณุชู</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">ููุด:</span>
                        <span class="detail-value">ูุฏุฑ ุงุฑุดุฏ</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">ุชุงุฑุฎ ุนุถูุช:</span>
                        <span class="detail-value">1402/01/15</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">ุขุฎุฑู ูุฑูุฏ:</span>
                        <span class="detail-value">1402/10/20 - 14:30</span>
                    </div>
                </div>

                <div class="account-actions">
                    <button class="btn btn-secondary" id="edit-profile-btn">
                        <i class="fas fa-edit"></i>
                        ูุฑุงุด ูพุฑููุงู
                    </button>
                    <button class="btn btn-danger" id="logout-btn">
                        <i class="fas fa-sign-out-alt"></i>
                        ุฎุฑูุฌ
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Notification Panel -->
    <div id="notification-panel" class="notification-panel hidden">
        <div class="notification-header">
            <h3>ุงุนูุงูโูุง</h3>
            <button class="close-btn" id="close-notification-panel">ร</button>
        </div>
        <div class="notification-list" id="notification-list"></div>
        <div class="notification-footer">
            <button class="btn btn-secondary" id="mark-all-read">ุนูุงูุชโฺฏุฐุงุฑ ููู</button>
            <button class="btn btn-danger" id="clear-all-notifications">ูพุงฺฉ ฺฉุฑุฏู ููู</button>
        </div>
    </div>

    <!-- Mobile Overlay -->
    <div id="mobile-overlay" class="mobile-overlay hidden"></div>

    <!-- Change Password Modal -->
    <div id="change-password-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ุชุบุฑ ุฑูุฒ ุนุจูุฑ</h3>
                <button class="close-btn" id="close-password-modal">ร</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="current-password">ุฑูุฒ ุนุจูุฑ ูุนู:</label>
                    <input type="password" id="current-password" class="form-input">
                </div>
                <div class="form-group">
                    <label for="new-password">ุฑูุฒ ุนุจูุฑ ุฌุฏุฏ:</label>
                    <input type="password" id="new-password" class="form-input">
                </div>
                <div class="form-group">
                    <label for="confirm-password">ุชุงุฏ ุฑูุฒ ุนุจูุฑ ุฌุฏุฏ:</label>
                    <input type="password" id="confirm-password" class="form-input">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-password-btn">ุงูุตุฑุงู</button>
                <button class="btn btn-primary" id="confirm-password-btn">
                    <i class="fas fa-key"></i>
                    ุชุบุฑ ุฑูุฒ ุนุจูุฑ
                </button>
            </div>
        </div>
    </div>

    <!-- Import Data Modal -->
    <div id="import-data-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ูุงุฑุฏุงุช ุฏุงุฏูโูุง</h3>
                <button class="close-btn" id="close-import-modal">ร</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="import-file">ุงูุชุฎุงุจ ูุงู:</label>
                    <input type="file" id="import-file" class="form-input" accept=".json,.zip">
                </div>
                <div class="form-group">
                    <label for="import-options">ฺฏุฒููโูุง ูุงุฑุฏุงุช:</label>
                    <div class="checkbox-group">
                        <label class="checkbox-item">
                            <input type="checkbox" checked> ุชูุธูุงุช
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" checked> ุฏุงุฏูโูุง ุดุฎุต
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox"> ุชุงุฑุฎฺู
                        </label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-import-btn">ุงูุตุฑุงู</button>
                <button class="btn btn-primary" id="confirm-import-btn">
                    <i class="fas fa-upload"></i>
                    ูุงุฑุฏุงุช
                </button>
            </div>
        </div>
    </div>

    <!-- JavaScript Modules -->
    <script src="js/core.js"></script>
    <script src="js/api-client.js"></script>
    <script src="js/state-manager.js"></script>
    <script src="js/navigation.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/document-manager.js"></script>
    <script src="js/file-handler.js"></script>
    <script src="js/search-engine.js"></script>
    <script src="js/chart-manager.js"></script>

    <!-- Initialize Settings Page -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('๐ Initializing Settings Page...');

            // Initialize all managers
            const managers = {
                core: window.dashboardCore,
                api: window.apiClient,
                state: window.stateManager,
                navigation: window.navigationManager,
                notifications: window.notificationManager,
                documents: window.documentManager,
                files: window.fileHandler,
                search: window.searchEngine,
                charts: window.chartManager
            };

            // Set up cross-component communication
            managers.core.broadcast('settings:initialized', { managers });

            // Initialize settings page functionality
            initializeSettingsPage();

            console.log('โ Settings page initialized successfully');
        });

        function initializeSettingsPage() {
            // Load current settings
            loadCurrentSettings();

            // Set up tabs
            setupSettingsTabs();

            // Set up event listeners
            setupSettingsEventListeners();

            // Set up form validation
            setupFormValidation();
        }

        function loadCurrentSettings() {
            // Load settings from localStorage or API
            const settings = {
                language: 'fa',
                timezone: 'Asia/Tehran',
                dateFormat: 'jalali',
                autoSave: true,
                autoSaveInterval: 5,
                theme: 'auto',
                colorScheme: '#3b82f6',
                fontSize: 'medium',
                animations: true,
                compactMode: false,
                notificationsEnabled: true,
                soundNotifications: true,
                emailNotifications: false,
                sessionTimeout: 30,
                twoFactorAuth: false,
                dataEncryption: true,
                debugMode: false,
                cacheSize: 100,
                apiTimeout: 30,
                maxUploadSize: 50,
                concurrentUploads: 3,
                exportFormat: 'pdf'
            };

            // Apply settings to form elements
            applySettingsToForm(settings);
        }

        function applySettingsToForm(settings) {
            // Apply settings to form elements
            Object.keys(settings).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    if (element.type === 'checkbox') {
                        element.checked = settings[key];
                    } else if (element.type === 'color') {
                        element.value = settings[key];
                        updateColorPreview(settings[key]);
                    } else {
                        element.value = settings[key];
                    }
                }
            });
        }

        function updateColorPreview(color) {
            const preview = document.querySelector('.color-preview');
            if (preview) {
                preview.style.backgroundColor = color;
            }
        }

        function setupSettingsTabs() {
            const tabBtns = document.querySelectorAll('.tab-btn');
            const tabPanes = document.querySelectorAll('.tab-pane');

            tabBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const targetTab = btn.dataset.tab;
                    
                    // Remove active class from all buttons and panes
                    tabBtns.forEach(b => b.classList.remove('active'));
                    tabPanes.forEach(p => p.classList.remove('active'));
                    
                    // Add active class to clicked button and corresponding pane
                    btn.classList.add('active');
                    document.getElementById(`${targetTab}-tab`).classList.add('active');
                });
            });
        }

        function setupSettingsEventListeners() {
            // Save settings button
            const saveBtn = document.getElementById('save-settings-btn');
            if (saveBtn) {
                saveBtn.addEventListener('click', () => {
                    saveSettings();
                });
            }

            // Reset settings button
            const resetBtn = document.getElementById('reset-settings-btn');
            if (resetBtn) {
                resetBtn.addEventListener('click', () => {
                    resetSettings();
                });
            }

            // Color scheme picker
            const colorPicker = document.getElementById('color-scheme');
            if (colorPicker) {
                colorPicker.addEventListener('change', (e) => {
                    updateColorPreview(e.target.value);
                });
            }

            // Change password button
            const changePasswordBtn = document.getElementById('change-password-btn');
            if (changePasswordBtn) {
                changePasswordBtn.addEventListener('click', () => {
                    showChangePasswordModal();
                });
            }

            // Export data button
            const exportDataBtn = document.getElementById('export-data-btn');
            if (exportDataBtn) {
                exportDataBtn.addEventListener('click', () => {
                    exportUserData();
                });
            }

            // Import data button
            const importDataBtn = document.getElementById('import-data-btn');
            if (importDataBtn) {
                importDataBtn.addEventListener('click', () => {
                    showImportDataModal();
                });
            }

            // Clear cache button
            const clearCacheBtn = document.getElementById('clear-cache-btn');
            if (clearCacheBtn) {
                clearCacheBtn.addEventListener('click', () => {
                    clearCache();
                });
            }

            // Reset all button
            const resetAllBtn = document.getElementById('reset-all-btn');
            if (resetAllBtn) {
                resetAllBtn.addEventListener('click', () => {
                    resetAllSettings();
                });
            }

            // Edit profile button
            const editProfileBtn = document.getElementById('edit-profile-btn');
            if (editProfileBtn) {
                editProfileBtn.addEventListener('click', () => {
                    editProfile();
                });
            }

            // Logout button
            const logoutBtn = document.getElementById('logout-btn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', () => {
                    logout();
                });
            }

            // Modal event listeners
            setupModalEventListeners();

            // Mobile menu toggle
            const mobileToggle = document.getElementById('mobile-menu-toggle');
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobile-overlay');

            if (mobileToggle && sidebar) {
                mobileToggle.addEventListener('click', () => {
                    sidebar.classList.toggle('open');
                    overlay.classList.toggle('hidden');
                });
            }

            if (overlay) {
                overlay.addEventListener('click', () => {
                    sidebar.classList.remove('open');
                    overlay.classList.add('hidden');
                });
            }

            // Notification panel
            const notificationBell = document.getElementById('notification-bell');
            const notificationPanel = document.getElementById('notification-panel');
            const closePanel = document.getElementById('close-notification-panel');

            if (notificationBell && notificationPanel) {
                notificationBell.addEventListener('click', () => {
                    notificationPanel.classList.toggle('hidden');
                });
            }

            if (closePanel && notificationPanel) {
                closePanel.addEventListener('click', () => {
                    notificationPanel.classList.add('hidden');
                });
            }
        }

        function setupModalEventListeners() {
            // Change password modal
            const passwordModal = document.getElementById('change-password-modal');
            const closePasswordBtn = document.getElementById('close-password-modal');
            const cancelPasswordBtn = document.getElementById('cancel-password-btn');
            const confirmPasswordBtn = document.getElementById('confirm-password-btn');

            if (closePasswordBtn && passwordModal) {
                closePasswordBtn.addEventListener('click', () => {
                    passwordModal.classList.add('hidden');
                });
            }

            if (cancelPasswordBtn && passwordModal) {
                cancelPasswordBtn.addEventListener('click', () => {
                    passwordModal.classList.add('hidden');
                });
            }

            if (confirmPasswordBtn && passwordModal) {
                confirmPasswordBtn.addEventListener('click', () => {
                    changePassword();
                });
            }

            if (passwordModal) {
                passwordModal.addEventListener('click', (e) => {
                    if (e.target === passwordModal) {
                        passwordModal.classList.add('hidden');
                    }
                });
            }

            // Import data modal
            const importModal = document.getElementById('import-data-modal');
            const closeImportBtn = document.getElementById('close-import-modal');
            const cancelImportBtn = document.getElementById('cancel-import-btn');
            const confirmImportBtn = document.getElementById('confirm-import-btn');

            if (closeImportBtn && importModal) {
                closeImportBtn.addEventListener('click', () => {
                    importModal.classList.add('hidden');
                });
            }

            if (cancelImportBtn && importModal) {
                cancelImportBtn.addEventListener('click', () => {
                    importModal.classList.add('hidden');
                });
            }

            if (confirmImportBtn && importModal) {
                confirmImportBtn.addEventListener('click', () => {
                    importUserData();
                });
            }

            if (importModal) {
                importModal.addEventListener('click', (e) => {
                    if (e.target === importModal) {
                        importModal.classList.add('hidden');
                    }
                });
            }
        }

        function setupFormValidation() {
            // Add form validation logic here
            console.log('Form validation setup complete');
        }

        function saveSettings() {
            const settings = collectFormSettings();
            
            // Save to localStorage
            localStorage.setItem('userSettings', JSON.stringify(settings));
            
            // Save to API if available
            if (window.apiClient) {
                window.apiClient.saveSettings(settings)
                    .then(() => {
                        showSuccess('ุฐุฎุฑู ุดุฏ', 'ุชูุธูุงุช ุจุง ููููุช ุฐุฎุฑู ุดุฏ');
                    })
                    .catch(error => {
                        showError('ุฎุทุง ุฏุฑ ุฐุฎุฑู', 'ุฎุทุง ุฏุฑ ุฐุฎุฑู ุชูุธูุงุช');
                    });
            } else {
                showSuccess('ุฐุฎุฑู ุดุฏ', 'ุชูุธูุงุช ุจุง ููููุช ุฐุฎุฑู ุดุฏ');
            }
        }

        function collectFormSettings() {
            const settings = {};
            
            // Collect all form values
            const formElements = document.querySelectorAll('input, select, textarea');
            formElements.forEach(element => {
                if (element.id) {
                    if (element.type === 'checkbox') {
                        settings[element.id] = element.checked;
                    } else {
                        settings[element.id] = element.value;
                    }
                }
            });
            
            return settings;
        }

        function resetSettings() {
            if (confirm('ุขุง ูุทูุฆู ูุณุชุฏ ฺฉู ูโุฎูุงูุฏ ุชูุธูุงุช ุฑุง ุจุงุฒูุดุงู ฺฉูุฏุ')) {
                // Reset to default settings
                const defaultSettings = {
                    language: 'fa',
                    timezone: 'Asia/Tehran',
                    dateFormat: 'jalali',
                    autoSave: true,
                    autoSaveInterval: 5,
                    theme: 'auto',
                    colorScheme: '#3b82f6',
                    fontSize: 'medium',
                    animations: true,
                    compactMode: false
                };
                
                applySettingsToForm(defaultSettings);
                showSuccess('ุจุงุฒูุดุงู ุดุฏ', 'ุชูุธูุงุช ุจู ุญุงูุช ูพุดโูุฑุถ ุจุงุฒฺฏุฑุฏุงูุฏู ุดุฏ');
            }
        }

        function showChangePasswordModal() {
            const modal = document.getElementById('change-password-modal');
            if (modal) {
                modal.classList.remove('hidden');
                // Clear form
                document.getElementById('current-password').value = '';
                document.getElementById('new-password').value = '';
                document.getElementById('confirm-password').value = '';
            }
        }

        function changePassword() {
            const currentPassword = document.getElementById('current-password').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;

            if (!currentPassword || !newPassword || !confirmPassword) {
                showError('ุฎุทุง', 'ูุทูุงู ุชูุงู ููุฏูุง ุฑุง ูพุฑ ฺฉูุฏ');
                return;
            }

            if (newPassword !== confirmPassword) {
                showError('ุฎุทุง', 'ุฑูุฒ ุนุจูุฑ ุฌุฏุฏ ู ุชุงุฏ ุขู ูุทุงุจูุช ูุฏุงุฑูุฏ');
                return;
            }

            if (newPassword.length < 8) {
                showError('ุฎุทุง', 'ุฑูุฒ ุนุจูุฑ ุฌุฏุฏ ุจุงุฏ ุญุฏุงูู 8 ฺฉุงุฑุงฺฉุชุฑ ุจุงุดุฏ');
                return;
            }

            // Simulate password change
            showLoadingState();
            setTimeout(() => {
                hideLoadingState();
                showSuccess('ุชุบุฑ ุฑูุฒ ุนุจูุฑ', 'ุฑูุฒ ุนุจูุฑ ุจุง ููููุช ุชุบุฑ ุงูุช');
                document.getElementById('change-password-modal').classList.add('hidden');
            }, 2000);
        }

        function exportUserData() {
            const userData = {
                settings: collectFormSettings(),
                profile: {
                    username: 'admin@legal.com',
                    fullName: 'ูุฏุฑ ุณุณุชู',
                    role: 'ูุฏุฑ ุงุฑุดุฏ',
                    joinDate: '1402/01/15'
                },
                timestamp: new Date().toISOString()
            };

            const dataStr = JSON.stringify(userData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'user-data.json';
            link.click();
            URL.revokeObjectURL(url);

            showSuccess('ุตุงุฏุฑุงุช ูููู', 'ุฏุงุฏูโูุง ฺฉุงุฑุจุฑ ุจุง ููููุช ุตุงุฏุฑ ุดุฏ');
        }

        function showImportDataModal() {
            const modal = document.getElementById('import-data-modal');
            if (modal) {
                modal.classList.remove('hidden');
            }
        }

        function importUserData() {
            const fileInput = document.getElementById('import-file');
            const file = fileInput.files[0];

            if (!file) {
                showError('ุฎุทุง', 'ูุทูุงู ูุงู ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    // Apply imported settings
                    if (data.settings) {
                        applySettingsToForm(data.settings);
                    }
                    
                    showSuccess('ูุงุฑุฏุงุช ูููู', 'ุฏุงุฏูโูุง ุจุง ููููุช ูุงุฑุฏ ุดุฏูุฏ');
                    document.getElementById('import-data-modal').classList.add('hidden');
                } catch (error) {
                    showError('ุฎุทุง', 'ูุงู ุงูุชุฎุงุจ ุดุฏู ูุนุชุจุฑ ูุณุช');
                }
            };
            reader.readAsText(file);
        }

        function clearCache() {
            if (confirm('ุขุง ูุทูุฆู ูุณุชุฏ ฺฉู ูโุฎูุงูุฏ ฺฉุด ุฑุง ูพุงฺฉ ฺฉูุฏุ')) {
                showLoadingState();
                setTimeout(() => {
                    hideLoadingState();
                    showSuccess('ูพุงฺฉ ุดุฏ', 'ฺฉุด ุจุง ููููุช ูพุงฺฉ ุดุฏ');
                }, 1500);
            }
        }

        function resetAllSettings() {
            if (confirm('ุขุง ูุทูุฆู ูุณุชุฏ ฺฉู ูโุฎูุงูุฏ ุชูุงู ุชูุธูุงุช ุฑุง ุจุงุฒูุดุงู ฺฉูุฏุ ุงู ุนูู ูุงุจู ุจุงุฒฺฏุดุช ูุณุช.')) {
                showLoadingState();
                setTimeout(() => {
                    hideLoadingState();
                    loadCurrentSettings(); // Reload default settings
                    showSuccess('ุจุงุฒูุดุงู ุดุฏ', 'ุชูุงู ุชูุธูุงุช ุจู ุญุงูุช ูพุดโูุฑุถ ุจุงุฒฺฏุฑุฏุงูุฏู ุดุฏ');
                }, 2000);
            }
        }

        function editProfile() {
            showSuccess('ูุฑุงุด ูพุฑููุงู', 'ุงู ูุงุจูุช ุฏุฑ ูุณุฎูโูุง ุขูุฏู ุงุถุงูู ุฎูุงูุฏ ุดุฏ');
        }

        function logout() {
            if (confirm('ุขุง ูุทูุฆู ูุณุชุฏ ฺฉู ูโุฎูุงูุฏ ุงุฒ ุญุณุงุจ ฺฉุงุฑุจุฑ ุฎุงุฑุฌ ุดูุฏุ')) {
                showLoadingState();
                setTimeout(() => {
                    hideLoadingState();
                    // Redirect to login page or show logout message
                    showSuccess('ุฎุฑูุฌ', 'ุจุง ููููุช ุงุฒ ุญุณุงุจ ฺฉุงุฑุจุฑ ุฎุงุฑุฌ ุดุฏุฏ');
                    setTimeout(() => {
                        window.location.href = 'index.html';
                    }, 2000);
                }, 1000);
            }
        }

        function showLoadingState() {
            const saveBtn = document.getElementById('save-settings-btn');
            if (saveBtn) {
                saveBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ุฏุฑ ุญุงู ุฐุฎุฑู...';
                saveBtn.disabled = true;
            }
        }

        function hideLoadingState() {
            const saveBtn = document.getElementById('save-settings-btn');
            if (saveBtn) {
                saveBtn.innerHTML = '<i class="fas fa-save"></i> ุฐุฎุฑู ุชูุธูุงุช';
                saveBtn.disabled = false;
            }
        }

        function showSuccess(title, message) {
            if (window.notificationManager) {
                window.notificationManager.showSuccess(title, message);
            } else {
                alert(`${title}: ${message}`);
            }
        }

        function showError(title, message) {
            if (window.notificationManager) {
                window.notificationManager.showError(title, message);
            } else {
                alert(`${title}: ${message}`);
            }
        }
    </script>
</body>
</html>